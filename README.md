# Парсер медицинских документов (ЭКГ)

Программа для автоматического извлечения данных из Word документов с описаниями ЭКГ и сохранения их в Excel таблицу.

## Требования к системе

1. Python 3.10 или выше
2. Установка библиотеки:
   ```bash
   pip install -r requirements.txt

   python word_parser.py
   ```

## Подготовка документов

### Требования к Word документу:
1. Формат файла должен быть `.docx` (не `.doc`)
2. Документ должен содержать следующие поля:
   ```
   ОПИСАНИЕ ЭЛЕКТРОКАРДИОГРАММЫ
   ФИО: [фамилия имя отчество]
   Возраст: [возраст или дата рождения]
   Отделение: [название отделения]
   Дата описания: [дата в формате ДД.ММ.ГГГГ]
   Заключение: [текст заключения]
   ```
3. В одном документе может быть несколько описаний ЭКГ
4. Документ не должен быть защищен паролем

## Использование программы

### Шаг 1: Подготовка файлов
1. Поместите файл `word_parser.py` в отдельную папку
2. В эту же папку скопируйте ваш Word документ с описаниями ЭКГ
3. Переименуйте Word документ в `input.docx`

### Шаг 2: Запуск программы
1. Откройте терминал или командную строку
2. Перейдите в папку с файлами:
   ```bash
   cd путь/к/папке/с/файлами
   ```
3. Запустите скрипт:
   ```bash
   python word_parser.py
   ```

### Шаг 3: Проверка результатов
1. После успешного выполнения программы в той же папке появится файл `output.xlsx`
2. В Excel файле будут следующие колонки:
   - № (номер записи)
   - Дата исследования
   - Исследование
   - ФИО
   - Возраст
   - Отделение
   - Заключение

## Возможные проблемы и их решение

### 1. "Файл не найден"
- Убедитесь, что Word документ называется `input.docx`
- Проверьте, что файл находится в той же папке, что и скрипт

### 2. "Неверный формат файла"
- Откройте документ в Microsoft Word
- Сохраните его через "Сохранить как" в формате `.docx`

### 3. "Файл поврежден или защищен паролем"
- Откройте документ в Microsoft Word
- Убедитесь, что он не защищен паролем
- Сохраните его заново

### 4. "Не удалось сохранить файл Excel"
- Закройте файл `output.xlsx`, если он открыт в Excel
- Убедитесь, что у вас есть права на запись в папку

### 5. "Не найдено ни одной записи в документе"
- Проверьте формат документа
- Убедитесь, что в документе есть текст "ОПИСАНИЕ ЭЛЕКТРОКАРДИОГРАММЫ"
- Проверьте наличие всех необходимых полей

## Дополнительная информация

1. Программа автоматически:
   - Создает новый Excel файл, если его нет
   - Добавляет новые записи в конец существующего файла
   - Настраивает ширину колонок для удобного просмотра
   - Игнорирует информацию о палатах

2. Для обработки другого документа:
   - Либо переименуйте его в `input.docx`
   - Либо измените имя файла в коде (строка `word_path = "input.docx"`)

3. Для изменения имени выходного Excel файла:
   - Измените имя файла в коде (строка `excel_path = "output.xlsx"`)

## Пример структуры документа

```
Государственное автономное учреждение здравоохранения
«Городская клиническая больница №7 имени М.Н. Садыкова»
Г. Казань, ул. Маршала Чуйкова 54
Отделение функциональной диагностики

ОПИСАНИЕ ЭЛЕКТРОКАРДИОГРАММЫ

ФИО: Иванов Иван Иванович
Возраст: 12.12.1978
Отделение: а/о
Дата описания: 16.04.2025 (ЭКГ от 15.04.2025)

Заключение: 
Синусовый ритм с ЧСС 71 уд/мин. Нормальное положение ЭОС.
```
